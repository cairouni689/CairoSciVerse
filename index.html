<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Security Headers Start -->
    <!-- Content-Security-Policy (CSP) to prevent XSS attacks -->
    <meta http-equiv="Content-Security-Policy" 
          content="default-src 'self'; 
                   script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com; 
                   style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
                   font-src 'self' https://fonts.gstatic.com; 
                   img-src 'self' data:;
                   object-src 'none';
                   frame-ancestors 'none';">

    <!-- Prevents clickjacking attacks for older browsers -->
    <meta http-equiv="X-Frame-Options" content="DENY">

    <!-- Prevents browser from MIME-sniffing a response away from the declared content-type -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    
    <!-- Controls how much referrer information is sent with requests -->
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <!-- Security Headers End -->
    
    <title>Cairo SciVerse</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark-purple: #0b091f;
            --bg-light-purple: #1e1a40;
            --accent-green: #80ff72;
            --text-main: #ffffff;
            --text-dark: #0b091f;
        }

        body {
            font-family: 'Cairo', sans-serif;
            color: var(--text-main);
        }
        .gradient-bg {
            background: linear-gradient(160deg, var(--bg-dark-purple), var(--bg-light-purple));
        }
        .quran-box {
            background-color: rgba(30, 26, 64, 0.7);
        }
        /* Styles for the side menu */
        .side-menu {
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            background-color: rgba(30, 26, 64, 0.8);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* Smoother transition */
            transform: translateX(100%); /* Start off-screen for RTL */
        }
        .side-menu.open {
            transform: translateX(0);
        }
        
        /* --- Animation Enhancements --- */

        /* General Smoothness */
        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Keyframes for animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(25px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pageEnter {
            from {
                opacity: 0;
                transform: perspective(800px) rotateX(-15deg) translateY(30px);
            }
            to {
                opacity: 1;
                transform: perspective(800px) rotateX(0deg) translateY(0);
            }
        }
        
        @keyframes linksEnter {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        @keyframes menuItemEnter {
             from {
                opacity: 0;
                transform: translateX(25px); /* Slide from left for RTL */
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Applying animations */
        .page-content {
            animation: pageEnter 0.7s ease-out forwards;
        }

        .animate-on-load {
            opacity: 0; /* Start hidden */
        }
        
        .fade-in-up-1 { animation: fadeInUp 0.6s 0.2s ease-out forwards; }
        .fade-in-up-2 { animation: fadeInUp 0.6s 0.3s ease-out forwards; }
        .fade-in-up-3 { animation: fadeInUp 0.6s 0.4s ease-out forwards; }
        .fade-in-up-4 { animation: fadeInUp 0.6s 0.5s ease-out forwards; }
        .fade-in-up-5 { animation: fadeInUp 0.6s 0.6s ease-out forwards; }
        .fade-in-up-6 { animation: fadeInUp 0.6s 0.7s ease-out forwards; }
        .fade-in-up-7 { animation: fadeInUp 0.6s 0.8s ease-out forwards; }
        .fade-in-up-8 { animation: fadeInUp 0.6s 0.9s ease-out forwards; }
        .fade-in-up-9 { animation: fadeInUp 0.6s 1.0s ease-out forwards; }
        .fade-in-up-10 { animation: fadeInUp 0.6s 1.1s ease-out forwards; }
        .fade-in-up-11 { animation: fadeInUp 0.6s 1.2s ease-out forwards; }
        .fade-in-up-12 { animation: fadeInUp 0.6s 1.3s ease-out forwards; }
        .fade-in-up-13 { animation: fadeInUp 0.6s 1.4s ease-out forwards; }
        .fade-in-up-14 { animation: fadeInUp 0.6s 1.5s ease-out forwards; }
        .fade-in-up-15 { animation: fadeInUp 0.6s 1.6s ease-out forwards; }
        .fade-in-up-16 { animation: fadeInUp 0.6s 1.7s ease-out forwards; }
        .fade-in-up-17 { animation: fadeInUp 0.6s 1.8s ease-out forwards; }
        .fade-in-up-18 { animation: fadeInUp 0.6s 1.9s ease-out forwards; }
        .fade-in-up-19 { animation: fadeInUp 0.6s 2.0s ease-out forwards; }
        .fade-in-up-20 { animation: fadeInUp 0.6s 2.1s ease-out forwards; }

        
        .menu-item-animate {
            opacity: 0;
            animation: menuItemEnter 0.5s ease-out forwards;
        }

        .links-enter {
          animation: linksEnter 0.5s ease-out;
        }

        .icon-container {
            transition: transform 0.3s ease, color 0.3s ease;
        }
        .icon-container:hover {
            transform: translateY(-5px);
            color: var(--accent-green);
        }

        .primary-btn {
            background-color: var(--accent-green);
            color: var(--text-dark);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .primary-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(128, 255, 114, 0.2);
        }

        /* --- Card Styles (Year, Semester, Subject) --- */
        .selection-card {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .selection-card:hover {
            transform: translateY(-8px);
            background-color: rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
        }
        .selection-card .icon-wrapper svg {
            width: 2.75rem; /* 44px */
            height: 2.75rem;
            stroke-width: 1.5;
            color: var(--accent-green);
            margin-bottom: 0.5rem;
        }
        .selection-card .card-text {
            font-size: 1.125rem; /* 18px */
            font-weight: 600;
            color: var(--text-main);
        }

        /* --- Subject Details & Tabs --- */
        .tab-btn {
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            border-radius: 9999px;
            color: rgba(255, 255, 255, 0.7);
            background-color: transparent;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .tab-btn.active {
            color: var(--accent-green);
            background-color: rgba(128, 255, 114, 0.1);
            border-color: rgba(128, 255, 114, 0.3);
        }
        .tab-content {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 1rem;
            padding: 1.5rem;
            min-height: 200px;
        }
        
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background-color: rgba(255,255,255,0.05);
            border-radius: 9999px;
            transition: background-color 0.2s;
        }
        .back-btn:hover {
            background-color: rgba(255,255,255,0.1);
        }
        
        /* --- Lecture Link Button Styles --- */
        .lecture-link-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            width: 80px; /* Fixed width for alignment */
            height: 80px; /* Fixed height for alignment */
            justify-content: center;
            border-radius: 0.75rem;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        .lecture-link-btn svg {
            width: 1.75rem; /* 28px */
            height: 1.75rem;
        }
        .lecture-link-btn .link-text {
            font-size: 0.875rem; /* 14px */
            font-weight: 600;
        }
        
        /* Enabled State */
        .lecture-link-btn.enabled {
            background-color: var(--accent-green);
            color: var(--text-dark);
        }
        .lecture-link-btn.enabled:hover {
             transform: scale(1.05);
             box-shadow: 0 4px 15px rgba(128, 255, 114, 0.2);
        }

        /* Disabled State */
        .lecture-link-btn.disabled {
            background-color: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.4);
            cursor: not-allowed;
            opacity: 0.7;
        }


    </style>
</head>
<body class="gradient-bg min-h-screen flex flex-col overflow-x-hidden">

    <div id="menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden transition-opacity duration-300"></div>
    <div id="side-menu" class="side-menu fixed top-0 right-0 h-full w-72 shadow-2xl z-50 p-6">
        <div class="flex justify-between items-center mb-10">
            <h2 class="text-2xl font-bold text-white">القائمة</h2>
            <button id="close-menu-btn" class="text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <nav>
            <ul class="space-y-2">
                <li><a href="#" data-target="page-home" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">الرئيسية</a></li>
                <li><a href="#" data-target="page-subjects" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">تعريف مواد اولى</a></li>
                <li><a href="#" data-target="page-general" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">الاقسام العامه</a></li>
                <!-- *** UPDATED: Renamed "Credit" to "Specialized Programs" *** -->
                <li><a href="#" data-target="page-credit" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">البرامج النوعية المتخصصه</a></li>
                <li><a href="#" data-target="page-after-grad" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">ماذا بعد التخرج</a></li>
                <li><a href="#" data-target="page-history" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">تاريخ الكلية</a></li>
                <!-- *** REMOVED: Summaries link *** -->
                <!-- <li><a href="#" data-target="page-summaries" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">الملخصات</a></li> -->
                <li><a href="#" data-target="page-about" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">عن فريق cairo SciVerse</a></li>
                <li><a href="#" data-target="page-contact" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">تواصل معنا</a></li>
            </ul>
        </nav>
    </div>

    <div id="app-container" class="flex-grow w-full px-6 md:px-12 py-6">

        <header class="flex justify-between items-center mb-12">
            <button id="open-menu-btn" class="text-3xl text-white z-20">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
            <h1 id="logo-text" class="text-2xl font-bold cursor-pointer">Cairo SciVerse</h1>
            <div id="logo-icon" class="w-10 h-10 bg-white bg-opacity-90 rounded-full flex items-center justify-center font-bold text-lg cursor-pointer" style="color: var(--bg-light-purple);">
                SV
            </div>
        </header>

        <main>
            <!-- ======================= HOME PAGE ======================= -->
            <div id="page-home" class="page-content">
                <div class="text-center my-10">
                    <h2 class="animate-on-load text-3xl md:text-4xl font-semibold leading-tight mb-10 max-w-lg mx-auto">
                        كل ما تحتاجه من معلومات ومصادر لرحلتك في كلية العلوم.
                    </h2>
                    <a href="#" id="start-exploring-btn" class="primary-btn animate-on-load font-bold py-3 px-12 rounded-full text-lg duration-300 inline-block shadow-lg">
                        ابدأ الاستكشاف
                    </a>
                    <div class="animate-on-load flex justify-center items-center gap-12 md:gap-16 my-12">
                        <div class="flex flex-col items-center space-y-3 text-white icon-container">
                            <div class="w-16 h-16 flex items-center justify-center text-3xl font-light">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6m0 10v-5m-3 5v-5m-6 5h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <span class="font-semibold">رياضة</span>
                        </div>
                        <div class="flex flex-col items-center space-y-3 text-white icon-container">
                            <div class="w-16 h-16 flex items-center justify-center text-3xl font-light">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                     <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                            </div>
                            <span class="font-semibold">فيزياء</span>
                        </div>
                        <div class="flex flex-col items-center space-y-3 text-white icon-container">
                             <div class="w-16 h-16 flex items-center justify-center text-3xl font-light">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547a2 2 0 00-.547 1.806l.477 2.387a6 6 0 00.517 3.86l.158.318a6 6 0 00.517 3.86l2.387.477a2 2 0 001.806-.547a2 2 0 00.547-1.806l-.477-2.387a6 6 0 00-.517-3.86l-.158-.318a6 6 0 00-.517-3.86l-2.387-.477a2 2 0 00-1.806.547a2 2 0 00-.547 1.806l.477 2.387a6 6 0 00.517 3.86l.158.318a6 6 0 00.517 3.86l2.387.477a2 2 0 001.806-.547a2 2 0 00.547-1.806l-.477-2.387a6 6 0 00-.517-3.86l-.158-.318a6 6 0 00-.517-3.86zM12 2a10 10 0 100 20 10 10 0 000-20z" />
                                </svg>
                            </div>
                            <span class="font-semibold">كيمياء</span>
                        </div>
                    </div>
                    <div class="animate-on-load my-12 max-w-md mx-auto">
                        <p class="text-lg text-gray-200 mb-6">وَذَكِّرْ فَإِنَّ الذِّكْرَىٰ تَنفَعُ الْمُؤْمِنِينَ</p>
                        <div class="quran-box p-6 rounded-2xl text-center shadow-lg">
                            <p id="quran-verse-text" class="text-xl leading-relaxed font-serif mb-4"></p>
                            <cite id="quran-verse-surah" class="not-italic text-gray-300"></cite>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ======================= ACADEMIC YEARS PAGE ======================= -->
            <div id="page-academic-years" class="page-content hidden">
                <div class="text-center p-8">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4 animate-on-load">اختر سنتك الدراسية</h2>
                    <p class="text-lg text-gray-200 mb-12 animate-on-load">تصفح المواد والمصادر الخاصة بكل مرحلة.</p>
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
                        <a href="#" class="selection-card year-choice animate-on-load" data-year="السنة الأولى">
                            <div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg></div>
                            <span class="card-text">السنة الأولى</span>
                        </a>
                        <a href="#" class="selection-card year-choice animate-on-load" data-year="السنة الثانية">
                            <div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 4h15M6 4v16h12V4M8 12h8" /></svg></div>
                            <span class="card-text">السنة الثانية</span>
                        </a>
                        <a href="#" class="selection-card year-choice animate-on-load" data-year="السنة الثالثة">
                            <div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="1.5" /><ellipse cx="12" cy="12" rx="10" ry="4" /><ellipse cx="12" cy="12" rx="4" ry="10" transform="rotate(60 12 12)" /><ellipse cx="12" cy="12" rx="4" ry="10" transform="rotate(-60 12 12)" /></svg></div>
                            <span class="card-text">السنة الثالثة</span>
                        </a>
                        <a href="#" class="selection-card year-choice animate-on-load" data-year="السنة الرابعة">
                            <div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4c0 5.523 4.477 10 10 10s10-4.477 10-10M4 20c0-5.523 4.477-10 10-10s10 4.477 10 10M8 8h8m-8 8h8" /></svg></div>
                            <span class="card-text">السنة الرابعة</span>
                        </a>
                        <a href="#" class="selection-card year-choice animate-on-load" data-year="دراسات عليا">
                            <div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M22 10v6M2 10l10-5 10 5-10 5z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M6 12v5c0 1.66 4 3 6 3s6-1.34 6-3v-5"></path></svg></div>
                            <span class="card-text">دراسات عليا</span>
                        </a>
                        <a href="#" class="selection-card year-choice animate-on-load" data-year="متطلبات الجامعة">
                            <div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.25l-6.18 3.77L7 14.14l-5-4.87 6.91-1.01L12 2z" /></svg></div>
                            <span class="card-text">متطلبات الجامعة</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- ======================= SEMESTERS PAGE ======================= -->
            <div id="page-semesters" class="page-content hidden">
                 <div class="text-center p-8">
                    <button class="back-btn mb-8" data-target="page-academic-years">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                        <span>العودة للسنوات</span>
                    </button>
                    <h2 id="semesters-title" class="text-3xl md:text-4xl font-bold mb-4 animate-on-load"></h2>
                    <p class="text-lg text-gray-200 mb-12 animate-on-load">اختر الفصل الدراسي لعرض المواد.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <a href="#" class="selection-card semester-choice animate-on-load" data-semester="1">
                           <div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-11 h-11"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></div>
                           <span class="card-text">الفصل الدراسي الأول</span>
                        </a>
                         <a href="#" class="selection-card semester-choice animate-on-load" data-semester="2">
                           <div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-11 h-11"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></div>
                           <span class="card-text">الفصل الدراسي الثاني</span>
                        </a>
                    </div>
                 </div>
            </div>
            
            <!-- ======================= DEPARTMENTS PAGE (NEW) ======================= -->
            <div id="page-departments" class="page-content hidden">
                 <div class="p-8">
                    <button class="back-btn mb-8" data-target="page-academic-years">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                        <span>العودة للسنوات</span>
                    </button>
                    <h2 id="departments-title" class="text-3xl md:text-4xl font-bold mb-10 text-center"></h2>
                    <div id="departments-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-5">
                        <!-- Department cards will be injected here by JS -->
                    </div>
                 </div>
            </div>

            <!-- ======================= SUBJECTS LIST PAGE ======================= -->
            <div id="page-subjects-list" class="page-content hidden">
                <div class="p-8">
                     <button id="subjects-back-btn" class="back-btn mb-8" data-target="page-semesters">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                        <span id="subjects-back-btn-text">العودة للفصول</span>
                    </button>
                    <h2 id="subjects-list-title" class="text-3xl md:text-4xl font-bold mb-10 text-center"></h2>
                    <div id="subjects-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-5">
                        <!-- Subject cards will be injected here by JS -->
                    </div>
                </div>
            </div>

            <!-- ======================= SUBJECT DETAIL PAGE ======================= -->
            <div id="page-subject-detail" class="page-content hidden">
                <div class="p-4 md:p-8">
                     <button class="back-btn mb-8" data-target="page-subjects-list">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                        <span>العودة للمواد</span>
                    </button>
                    <h2 id="subject-detail-title" class="text-3xl md:text-4xl font-bold mb-8 text-center"></h2>
                    <div class="flex justify-center flex-wrap gap-2 md:gap-4 mb-6" id="tabs-buttons-container">
                        <button class="tab-btn active" data-tab="tab-summaries">ملخصات</button>
                        <button class="tab-btn" data-tab="tab-lectures">المحاضرات</button>
                        <button class="tab-btn" data-tab="tab-instructions">تعليمات المادة</button>
                    </div>
                    <div id="tabs-content-container">
                        <div id="tab-summaries" class="tab-content">
                            <h3 class="text-2xl font-semibold mb-4">ملخصات المادة</h3>
                            <p>هنا ستجد ملخصات ومراجعات هامة للمادة لمساعدتك على الاستعداد للامتحانات.</p>
                        </div>
                        <!-- *** UPDATED LECTURES TAB *** -->
                        <div id="tab-lectures" class="tab-content hidden">
                             <h3 class="text-2xl font-semibold mb-4">محاضرات المادة</h3>
                             <!-- Container for dynamic lecture cards -->
                            <div id="tab-lectures-content" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Lecture cards will be injected here by JavaScript -->
                                <!-- 
                                Example structure:
                                <div class="bg-white bg-opacity-5 p-4 rounded-lg shadow-lg">
                                    <h4 class="text-xl font-semibold mb-4 text-white">المحاضرة 1</h4>
                                    <div class="flex items-center justify-center gap-6">
                                        <a href="..." target="_blank" class="lecture-link-btn enabled">
                                            <svg>...</svg>
                                            <span class="link-text">المحاضرة</span>
                                        </a>
                                        <div class="lecture-link-btn disabled">
                                            <svg>...</svg>
                                            <span class="link-text">المعمل</span>
                                        </div>
                                        <a href="..." target="_blank" class="lecture-link-btn enabled">
                                            <svg>...</svg>
                                            <span class="link-text">PDF</span>
                                        </a>
                                    </div>
                                </div> 
                                -->
                            </div>
                        </div>
                        <!-- *** END UPDATED TAB *** -->
                        <div id="tab-instructions" class="tab-content hidden">
                            <h3 class="text-2xl font-semibold mb-4">تعليمات هامة</h3>
                            <p>نصائح وإرشادات حول كيفية دراسة المادة، طبيعة الامتحانات، وأفضل طرق المذاكرة.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ======================= OTHER STATIC PAGES ======================= -->
            <div id="page-subjects" class="page-content hidden"><div class="text-center p-8"><h2 class="text-4xl font-bold mb-4">تعريف مواد أولى</h2><p class="text-lg text-gray-200">هنا سيتم عرض شرح تفصيلي لمواد الفرقة الأولى في كلية العلوم.</p></div></div>
            <div id="page-general" class="page-content hidden"><div class="text-center p-8"><h2 class="text-4xl font-bold mb-4">الأقسام العامة</h2><p class="text-lg text-gray-200">تفاصيل ومعلومات عن الأقسام العامة المتاحة في الكلية.</p></div></div>
            <!-- *** UPDATED: Renamed "Credit" page title and text *** -->
            <div id="page-credit" class="page-content hidden"><div class="text-center p-8"><h2 class="text-4xl font-bold mb-4">البرامج النوعية المتخصصه</h2><p class="text-lg text-gray-200">استعراض للبرامج المتاحة بنظام الساعات المعتمدة (البرامج النوعية المتخصصه).</p></div></div>
            <div id="page-after-grad" class="page-content hidden"><div class="text-center p-8"><h2 class="text-4xl font-bold mb-4">ماذا بعد التخرج</h2><p class="text-lg text-gray-200">نظرة على المسارات الوظيفية والأكاديمية المتاحة لخريجي كلية العلوم.</p></div></div>
            <div id="page-history" class="page-content hidden"><div class="text-center p-8"><h2 class="text-4xl font-bold mb-4">تاريخ الكلية</h2><p class="text-lg text-gray-200">نبذة عن تاريخ إنشاء وتطور كلية العلوم.</p></div></div>
            <!-- *** This page is now orphaned as the link is removed, but we leave it *** -->
            <div id="page-summaries" class="page-content hidden"><div class="text-center p-8"><h2 class="text-4xl font-bold mb-4">الملخصات</h2><p class="text-lg text-gray-200">هنا يمكنك تصفح ومشاركة الملخصات الدراسية المختلفة.</p></div></div>
            <div id="page-about" class="page-content hidden"><div class="text-center p-8"><h2 class="text-4xl font-bold mb-4">عن فريق Cairo SciVerse</h2><p class="text-lg text-gray-200">تعرف على الفريق القائم على هذا المشروع وأهدافه.</p></div></div>
            <div id="page-contact" class="page-content hidden">
                <div class="text-center p-8">
                    <h2 class="text-4xl font-bold mb-4 animate-on-load">تواصل معنا</h2>
                    <p class="text-lg text-gray-200 mb-8 animate-on-load">يمكنك التواصل معنا عبر وسائل التواصل الاجتماعي أو البريد الإلكتروني.</p>
                    <button id="show-links-btn" class="primary-btn font-bold py-3 px-8 rounded-full text-lg duration-300 inline-block shadow-lg animate-on-load">
                        كل ما يخصنا
                    </button>
                    <div id="social-links-container" class="hidden max-w-sm mx-auto mt-8 space-y-4">
                        <a href="https://www.facebook.com/share/1A3ns3whzY/" target="_blank" class="flex items-center justify-center p-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-300">
                           <svg class="w-6 h-6 ml-3" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22.675 0H1.325C.593 0 0 .593 0 1.325v21.35C0 23.407.593 24 1.325 24H12.82v-9.29h-3.128v-3.622h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116c.732 0 1.325-.593 1.325-1.325V1.325C24 .593 23.407 0 22.675 0z"></path></svg>
                           <span class="font-semibold">صفحة الفيسبوك</span>
                        </a>
                        <a href="https://youtube.com/@cairo_sciverse_0?si=cKP0Dk15RMKsvCCx" target="_blank" class="flex items-center justify-center p-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-300">
                           <svg class="w-6 h-6 ml-3" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path></svg>
                           <span class="font-semibold">قناة اليوتيوب</span>
                        </a>
                        <a href="https://chat.whatsapp.com/DLbeD1yHlJWBkxo1FSilv5?mode=ems_copy_t" target="_blank" class="flex items-center justify-center p-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-300">
                           <svg class="w-6 h-6 ml-3" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.267.655 4.512 1.924 6.341l-.225 1.419 1.436-.211z"></path></svg>
                           <span class="font-semibold">جروب الواتساب</span>
                        </a>
                        <a href="https://drive.google.com/drive/folders/1fhU3sDPvmPSeVAeFj81E6alywjpivIkS" target="_blank" class="flex items-center justify-center p-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-all duration-300">
                           <svg class="w-6 h-6 ml-3" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.333 3.333H4.667C3.933 3.333 3.342 3.933 3.342 4.667L3.333 19.333C3.333 20.067 3.933 20.667 4.667 20.667H19.333C20.067 20.667 20.667 20.067 20.667 19.333V4.667C20.667 3.933 20.067 3.333 19.333 3.333ZM16.417 13.083L12.9 16.583C12.708 16.783 12.358 16.783 12.167 16.583L10.333 14.75L7.583 17.5C7.392 17.692 7.042 17.692 6.85 17.5L4.417 15.067C4.225 14.875 4.225 14.525 4.417 14.333L10.417 8.333C10.608 8.142 10.958 8.142 11.15 8.333L12.983 10.167L16.417 6.742C16.608 6.55 16.958 6.55 17.15 6.742L19.583 9.175C19.775 9.367 19.775 9.717 19.583 9.908L16.417 13.083Z"></path></svg>
                           <span class="font-semibold">جوجل درايف</span>
                        </a>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <footer class="text-center text-gray-200 text-sm pb-8 px-4">
        <p class="mb-2">بُني هذا الصرح الرقمي لإلهام ودعم كل طالب علم. من فريق Cairo SciVerse إلى زملائنا.</p>
        <p>&copy; 2025 | موقع Cairo SciVerse. كل الحقوق محفوظة.</p>
    </footer>
    
    <div class="w-full bg-transparent flex justify-center py-4">
      <div class="w-32 h-1.5 bg-white rounded-full bg-opacity-20"></div>
    </div>

    <script>
        // --- State Management & Data ---
        let currentYear = '';
        let currentSemester = '';
        let currentDepartment = '';

        const newDepartments = [
            'رياضيات منفرد', 'علوم حاسب منفرد', 'فيزياء منفرد', 'كيمياء منفرد', 'جيولوجيا منفرد', 
            'علوم فضاء(فلك)', 'بايوفيزياء منفرد', 'جيوفيزياء منفرد', 'رياضيات/إحصاء', 'رياضيات/علوم حاسب', 
            'رياضيات/فيزياء', 'فيزياء/فلك', 'فيزياء/علوم جوية', 'كيمياء/فيزياء', 'كيمياء/كيمياء حيوي', 
            'كيمياء/نبات', 'كيمياء/ميكروبيولوجي', 'كيمياء/حيوان', 'كيمياء/جيولوجيا', 'كيمياء/حشرات'
        ];

        const departmentsData = {
            'السنة الثانية': newDepartments,
            'السنة الثالثة': newDepartments,
            'السنة الرابعة': newDepartments,
        };
        
        // --- Daily Verse Logic ---
        const dailyVerses = [
            { text: "إِنَّ فِي خَلْقِ السَّمَاوَاتِ وَالْأَرْضِ وَاخْتِلَافِ اللَّيْلِ وَالنَّهَارِ لَآيَاتٍ لِّأُولِي الْأَلْبَابِ", surah: "سورة آل عمران، 190" },
            { text: "وَقُل رَّبِّ زِدْنِي عِلْمًا", surah: "سورة طه، 114" },
            { text: "يَرْفَعِ اللَّهُ الَّذِينَ آمَنُوا مِنكُمْ وَالَّذِينَ أُوتُوا الْعِلْمَ دَرَجَاتٍ", surah: "سورة المجادلة، 11" },
            { text: "فَاصْبِرْ صَبْرًا جَمِيلًا", surah: "سورة المعارج، 5" },
            { text: "وَعَسَىٰ أَن تَكْرَهُوا شَيْئًا وَهُوَ خَيْرٌ لَّكُمْ", surah: "سورة البقرة، 216" },
            { text: "لَا يُكَلِّفُ اللَّهُ نَفْسًا إِلَّا وُسْعَهَا", surah: "سورة البقرة، 286" },
            { text: "وَمَن يَتَوَكَّلْ عَلَى اللَّهِ فَهُوَ حَسْبُهُ", surah: "سورة الطلاق، 3" },
            { text: "اقْرَأْ بِاسْمِ رَبِّكَ الَّذِي خَلَقَ", surah: "سورة العلق، 1" }
        ];

        // --- *** NEW: Helper to create 8 lecture stubs, mostly disabled *** ---
        function createLectureStubs() {
            return [
                { youtube: '#', lab: null, pdf: '#' }, // Lec 1 (some data)
                { youtube: null, lab: null, pdf: null }, // Lec 2 (no data)
                { youtube: null, lab: null, pdf: '#' }, // Lec 3 (pdf only)
                { youtube: null, lab: null, pdf: null }, // Lec 4
                { youtube: '#', lab: '#', pdf: null }, // Lec 5 (yt and lab)
                { youtube: null, lab: null, pdf: null }, // Lec 6
                { youtube: null, lab: null, pdf: null }, // Lec 7
                { youtube: null, lab: null, pdf: null }  // Lec 8
            ];
        }
        
        // --- *** UPDATED DATA STRUCTURE *** ---
        // All subjects now follow the object structure with 8 lecture stubs
        const subjectsData = {
            'السنة الأولى': {
                '1': [
                    { 
                        name: 'كيمياء عامة (1)', 
                        id: 'chem1', 
                        lectures: [
                            { youtube: '#', lab: '#', pdf: '#' }, { youtube: '#', lab: null, pdf: '#' },
                            { youtube: '#', lab: '#', pdf: null }, { youtube: '#', lab: '#', pdf: '#' },
                            { youtube: null, lab: null, pdf: '#' }, { youtube: '#', lab: '#', pdf: '#' },
                            { youtube: null, lab: null, pdf: null }, { youtube: '#', lab: '#', pdf: '#' }
                        ]
                    },
                    { 
                        name: 'فيزياء عامة (1)', 
                        id: 'phys1',
                        lectures: [
                            { youtube: '#', lab: '#', pdf: '#' }, { youtube: '#', lab: '#', pdf: '#' },
                            { youtube: null, lab: null, pdf: '#' }, { youtube: '#', lab: '#', pdf: '#' },
                            { youtube: '#', lab: null, pdf: '#' }, { youtube: '#', lab: '#', pdf: '#' },
                            { youtube: '#', lab: '#', pdf: '#' }, { youtube: null, lab: null, pdf: null }
                        ]
                    },
                    { name: 'رياضيات (1)', id: 'math1', lectures: createLectureStubs() },
                    { name: 'جيولوجيا عامة', id: 'geo1', lectures: createLectureStubs() },
                    { name: 'حيوان عام', id: 'zoo1', lectures: createLectureStubs() },
                    { name: 'نبات عام', id: 'bot1', lectures: createLectureStubs() }
                ],
                '2': [
                    { name: 'كيمياء عامة (2)', id: 'chem2', lectures: createLectureStubs() },
                    { name: 'فيزياء عامة (2)', id: 'phys2', lectures: createLectureStubs() },
                    { name: 'رياضيات (2)', id: 'math2', lectures: createLectureStubs() },
                    { name: 'ميكانيكا', id: 'mech1', lectures: createLectureStubs() },
                    { name: 'مقدمة في الحاسب', id: 'cs1', lectures: createLectureStubs() },
                    { name: 'لغة إنجليزية', id: 'eng1', lectures: createLectureStubs() }
                ]
            },
            'السنة الثانية': {
                'رياضيات منفرد': [
                    { name: 'تحليل رياضي (3)', id: 'math-ana3', lectures: createLectureStubs() },
                    { name: 'جبر (2)', id: 'math-alg2', lectures: createLectureStubs() },
                    { name: 'معادلات تفاضلية (2)', id: 'math-de2', lectures: createLectureStubs() },
                    { name: 'ميكانيكا تحليلية', id: 'math-mech2', lectures: createLectureStubs() }
                ],
                'فيزياء منفرد': [
                    { name: 'كهربية ومغناطيسية (1)', id: 'phys-em1', lectures: createLectureStubs() },
                    { name: 'ديناميكا حرارية', id: 'phys-thermo', lectures: createLectureStubs() },
                    { name: 'فيزياء حديثة (1)', id: 'phys-mod1', lectures: createLectureStubs() },
                    { name: 'بصريات فيزيائية', id: 'phys-optics', lectures: createLectureStubs() }
                ],
                'كيمياء منفرد': [
                    { name: 'كيمياء فيزيائية (2)', id: 'chem-phys2', lectures: createLectureStubs() },
                    { name: 'كيمياء عضوية (2)', id: 'chem-org2', lectures: createLectureStubs() },
                    { name: 'كيمياء غير عضوية (2)', id: 'chem-inorg2', lectures: createLectureStubs() },
                    { name: 'كيمياء تحليلية (2)', id: 'chem-ana2', lectures: createLectureStubs() }
                ],
                // Placeholder for other departments
                'جيولوجيا منفرد': [ { name: 'علم المعادن', id: 'geo-min', lectures: createLectureStubs() } ],
                'علوم حاسب منفرد': [ { name: 'هياكل بيانات', id: 'cs-ds', lectures: createLectureStubs() } ]
            },
            // Placeholder data for Year 3 and 4
            'السنة الثالثة': {
                 'رياضيات منفرد': [
                    { name: 'تحليل مركب (1)', id: 'math-comp1', lectures: createLectureStubs() },
                    { name: 'جبر (3)', id: 'math-alg3', lectures: createLectureStubs() }
                ],
                'فيزياء منفرد': [
                    { name: 'ميكانيكا الكم (1)', id: 'phys-qm1', lectures: createLectureStubs() },
                    { name: 'فيزياء إحصائية (1)', id: 'phys-stat1', lectures: createLectureStubs() }
                ],
                'كيمياء منفرد': [
                    { name: 'كيمياء فيزيائية (3)', id: 'chem-phys3', lectures: createLectureStubs() },
                    { name: 'كيمياء عضوية (3)', id: 'chem-org3', lectures: createLectureStubs() }
                ]
            },
            'السنة الرابعة': {
                 'رياضيات منفرد': [
                    { name: 'تحليل دالي', id: 'math-func', lectures: createLectureStubs() },
                    { name: 'مشروع تخرج رياضيات', id: 'math-proj', lectures: createLectureStubs() }
                ],
                'فيزياء منفرد': [
                    { name: 'فيزياء الجوامد (1)', id: 'phys-solid1', lectures: createLectureStubs() },
                    { name: 'مشروع تخرج فيزياء', id: 'phys-proj', lectures: createLectureStubs() }
                ],
                'كيمياء منفرد': [
                    { name: 'كيمياء فيزيائية (4)', id: 'chem-phys4', lectures: createLectureStubs() },
                    { name: 'مشروع تخرج كيمياء', id: 'chem-proj', lectures: createLectureStubs() }
                ]
            },
            'متطلبات الجامعة': [
                { name: 'قضايا مجتمعية', id: 'uni-social', icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m-7.5-2.962A3.75 3.75 0 0112 15v-2.25A3.75 3.75 0 0115.75 9h-1.5a2.25 2.25 0 01-2.25-2.25v-1.5A3.75 3.75 0 0112 3v2.25A3.75 3.75 0 018.25 9h1.5a2.25 2.25 0 012.25 2.25v1.5m-3.75-2.25a3.75 3.75 0 00-3.75 3.75v2.25A3.75 3.75 0 0012 18.75v-2.25A3.75 3.75 0 008.25 12h-1.5a2.25 2.25 0 00-2.25 2.25v1.5A3.75 3.75 0 006 18.75v-2.25A3.75 3.75 0 002.25 12h1.5A2.25 2.25 0 006 9.75v-1.5A3.75 3.75 0 002.25 6v2.25a3.75 3.75 0 003.75 3.75h1.5a2.25 2.25 0 002.25-2.25v-1.5A3.75 3.75 0 006 3v2.25A3.75 3.75 0 009.75 9h-1.5a2.25 2.25 0 00-2.25 2.25v1.5" /></svg>', lectures: createLectureStubs() },
                { name: 'مبادئ القانون والدستور', id: 'uni-law', icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>', lectures: createLectureStubs() },
                { name: 'حاسب آلي', id: 'uni-cs', icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25A2.25 2.25 0 015.25 3h13.5A2.25 2.25 0 0121 5.25z" /></svg>', lectures: createLectureStubs() },
                { name: 'لغة انجليزية', id: 'uni-eng', icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418" /></svg>', lectures: createLectureStubs() }
            ],
            'دراسات عليا': {
                '1': [
                    { name: 'مناهج بحث علمي', id: 'grad-research', lectures: createLectureStubs() },
                    { name: 'إحصاء متقدم', id: 'grad-stats', lectures: createLectureStubs() },
                    { name: 'مادة تخصصية 1', id: 'grad-spec1', lectures: createLectureStubs() }
                ],
                '2': [
                    { name: 'مادة تخصصية 2', id: 'grad-spec2', lectures: createLectureStubs() },
                    { name: 'كتابة علمية', id: 'grad-writing', lectures: createLectureStubs() },
                    { name: 'مشروع التخرج', id: 'grad-proj', lectures: createLectureStubs() }
                ]
            }
        };
        
        // --- Helper function to save current state to sessionStorage ---
        function saveState() {
            sessionStorage.setItem('currentYear', currentYear);
            sessionStorage.setItem('currentSemester', currentSemester);
            sessionStorage.setItem('currentDepartment', currentDepartment);
        }

        function setDailyVerse() {
            const verseTextElement = document.getElementById('quran-verse-text');
            const verseSurahElement = document.getElementById('quran-verse-surah');
            
            if (dailyVerses.length > 0 && verseTextElement && verseSurahElement) {
                const dayOfYear = Math.floor(Date.now() / 86400000);
                const verseIndex = dayOfYear % dailyVerses.length;
                const todayVerse = dailyVerses[verseIndex];

                verseTextElement.textContent = `"${todayVerse.text}"`;
                verseSurahElement.textContent = todayVerse.surah;
            }
        }
        
        // --- Navigation Logic ---
        const openMenuBtn = document.getElementById('open-menu-btn');
        const closeMenuBtn = document.getElementById('close-menu-btn');
        const sideMenu = document.getElementById('side-menu');
        const menuOverlay = document.getElementById('menu-overlay');
        const menuLinks = document.querySelectorAll('.menu-link');
        const pageContents = document.querySelectorAll('.page-content');
        const startExploringBtn = document.getElementById('start-exploring-btn');
        const showLinksBtn = document.getElementById('show-links-btn');
        const socialLinksContainer = document.getElementById('social-links-container');
        const logoText = document.getElementById('logo-text');
        const logoIcon = document.getElementById('logo-icon');

        function openMenu() {
            sideMenu.classList.add('open');
            menuOverlay.classList.remove('hidden');
            document.documentElement.style.overflow = 'hidden';
            document.body.style.overflow = 'hidden';
            
            const links = sideMenu.querySelectorAll('.menu-link');
            links.forEach((link, index) => {
                link.classList.add('menu-item-animate');
                link.style.animationDelay = `${index * 0.07 + 0.1}s`;
            });
        }

        function closeMenu() {
            sideMenu.classList.remove('open');
            menuOverlay.classList.add('hidden');
            document.documentElement.style.overflow = '';
            document.body.style.overflow = '';

            const links = sideMenu.querySelectorAll('.menu-link');
            links.forEach(link => {
                link.classList.remove('menu-item-animate');
                link.style.animationDelay = '';
            });
        }

        function navigateToPage(targetId, isFromPopState = false) {
            let targetPage = document.getElementById(targetId);
            if (!targetPage) {
                targetId = 'page-home';
                targetPage = document.getElementById(targetId);
            }

            if (!isFromPopState) {
                const state = { pageId: targetId };
                const title = targetPage.querySelector('h2')?.textContent || 'Cairo SciVerse';
                const url = `#${targetId}`;
                if (window.location.hash !== url) {
                    history.pushState(state, title, url);
                }
            }
            
            // Before showing a page, ensure its dynamic content is populated
            if (targetId === 'page-semesters') {
                document.getElementById('semesters-title').textContent = currentYear;
            } else if (targetId === 'page-departments') {
                displayDepartments();
            } else if (targetId === 'page-subjects-list') {
                displaySubjects();
            }


            pageContents.forEach(page => page.classList.add('hidden'));
            
            targetPage.classList.remove('hidden');
            window.scrollTo(0, 0);

            // Reset and trigger animations for the new page
            const elementsToAnimate = targetPage.querySelectorAll('.animate-on-load');
            elementsToAnimate.forEach((el, index) => {
                el.className = el.className.replace(/\bfade-in-up-\d+\b/g, '').trim();
                setTimeout(() => {
                    el.classList.add(`fade-in-up-${index + 1}`);
                }, 10);
            });
            
            closeMenu();
        }

        // --- *** NEW HELPER FUNCTION TO CREATE LECTURE BUTTONS *** ---
        function generateLinkButton(link, type) {
            let icon = '';
            let text = '';
            
            if (type === 'youtube') {
                // YouTube (Play) Icon
                icon = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm14.024-.983a1.125 1.125 0 010 1.966l-5.603 3.08a1.125 1.125 0 01-1.68-.983V8.9a1.125 1.125 0 011.68-.983l5.603 3.08z" clip-rule="evenodd" /></svg>`;
                text = 'المحاضرة';
            } else if (type === 'lab') {
                // Lab (Beaker) Icon
                icon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M14.25 2.25c.399 0 .79.04.1.05v.39c0 .32-.15.63-.42.85l-1.08.81a1.5 1.5 0 01-1.8 0L9.12 4.3a.98.98 0 01-.42-.85V3.3c.21-.01.401-.05.1-.05h5.1zM6.88 8.03l-.06-.05a1.8 1.8 0 00-1.58 0L3.12 9.6a1.5 1.5 0 000 2.8l2.12 1.58c.53.4 1.2.6 1.8.6h8.1a1.8 1.8 0 001.8-.6l2.12-1.58a1.5 1.5 0 000-2.8L15.6 7.98a1.8 1.8 0 00-1.58 0l-.06.05v5.94c0 1.02-.83 1.85-1.85 1.85h-2.14a1.85 1.85 0 01-1.85-1.85V8.03z" /></svg>`;
                text = 'المعمل';
            } else if (type === 'pdf') {
                // PDF (Document) Icon
                icon = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0016.5 9h-1.875a.375.375 0 01-.375-.375V6.75A3.75 3.75 0 009 3H5.625zM10.125 6a.375.375 0 00-.375.375v1.875c0 2.071 1.679 3.75 3.75 3.75H15a.375.375 0 00.375-.375V9.75A1.875 1.875 0 0013.5 7.875h-1.875a.375.375 0 01-.375-.375V5.625A1.875 1.875 0 009.375 3.75H7.875a.375.375 0 00-.375.375v1.875z" clip-rule="evenodd" /></svg>`;
                text = 'PDF';
            }

            if (link) {
                // If link exists, return an enabled <a> tag
                return `
                    <a href="${link}" target="_blank" rel="noopener noreferrer" class="lecture-link-btn enabled">
                        ${icon}
                        <span class="link-text">${text}</span>
                    </a>
                `;
            } else {
                // If link is null, return a disabled <div>
                return `
                    <div class="lecture-link-btn disabled">
                        ${icon}
                        <span class="link-text">${text}</span>
                    </div>
                `;
            }
        }
        
        function displayDepartments() {
            const departmentsContainer = document.getElementById('departments-container');
            const departmentsTitle = document.getElementById('departments-title');

            departmentsContainer.innerHTML = ''; 
            departmentsTitle.textContent = `أقسام ${currentYear}`;

            const departments = departmentsData[currentYear];
            if (departments && departments.length > 0) {
                 departments.forEach((deptName, index) => {
                    const deptCard = `
                        <a href="#" class="selection-card department-choice animate-on-load fade-in-up-${index + 1}" 
                           data-department="${deptName}"
                           data-subject-name="${deptName}" 
                           data-subject-id="${deptName}">
                            <span class="card-text text-base">${deptName}</span>
                        </a>
                    `;
                    departmentsContainer.innerHTML += deptCard;
                });
            } else {
                 departmentsContainer.innerHTML = `<p class="text-center col-span-full text-gray-300">لا توجد أقسام متاحة حاليًا لهذا الاختيار.</p>`;
            }

            document.querySelectorAll('.department-choice').forEach(card => {
                card.addEventListener('click', e => {
                    e.preventDefault();
                    currentDepartment = card.dataset.department;
                    saveState(); // Save state
                    displaySubjects();
                    navigateToPage('page-subjects-list');
                });
            });
        }

        // --- *** UPDATED FUNCTION TO HANDLE NEW DATA *** ---
        function displaySubjects() {
            const subjectsContainer = document.getElementById('subjects-container');
            const subjectsListTitle = document.getElementById('subjects-list-title');
            const subjectsBackBtn = document.getElementById('subjects-back-btn');
            const subjectsBackBtnText = document.getElementById('subjects-back-btn-text');
            
            subjectsContainer.innerHTML = '';
            
            let subjects;
            const yearsWithDepartments = ['السنة الثانية', 'السنة الثالثة', 'السنة الرابعة'];

            if (currentYear === 'متطلبات الجامعة') {
                subjects = subjectsData[currentYear];
                subjectsListTitle.textContent = 'مواد متطلبات الجامعة';
                subjectsBackBtn.dataset.target = 'page-academic-years';
                subjectsBackBtnText.textContent = 'العودة للسنوات';
            } else if (yearsWithDepartments.includes(currentYear)) {
                subjects = subjectsData[currentYear]?.[currentDepartment];
                subjectsListTitle.textContent = `مواد ${currentDepartment}`;
                subjectsBackBtn.dataset.target = 'page-departments';
                subjectsBackBtnText.textContent = 'العودة للأقسام';
            } else { 
                // Handles 'السنة الأولى' and 'دراسات عليا'
                subjects = subjectsData[currentYear]?.[currentSemester];
                const semesterText = currentSemester === '1' ? 'الأول' : 'الثاني';
                subjectsListTitle.textContent = `مواد ${currentYear} - الفصل الدراسي ${semesterText}`;
                subjectsBackBtn.dataset.target = 'page-semesters';
                subjectsBackBtnText.textContent = 'العودة للفصول';
            }

            if (subjects && subjects.length > 0) {
                // Loop through subjects (all should be objects now)
                subjects.forEach((subject, index) => {
                    const isObject = typeof subject === 'object' && subject !== null;
                    const subjectName = isObject ? subject.name : subject;
                    const subjectId = isObject ? subject.id : subjectName; // Use name as ID if it's just a string
                    const subjectIcon = isObject ? (subject.icon || '') : ''; // Handle icon

                    const subjectCard = `
                        <a href="#" class="selection-card subject-choice animate-on-load fade-in-up-${index + 1}" 
                           data-subject-name="${subjectName}" 
                           data-subject-id="${subjectId}">
                            ${subjectIcon ? `<div class="icon-wrapper">${subjectIcon}</div>` : ''}
                            <span class="card-text text-lg">${subjectName}</span>
                        </a>
                    `;
                    subjectsContainer.innerHTML += subjectCard;
                });
            } else {
                subjectsContainer.innerHTML = `<p class="text-center col-span-full text-gray-300">لا توجد مواد متاحة حاليًا لهذا الاختيار.</p>`;
            }

            // --- *** UPDATED CLICK LISTENER FOR SUBJECTS *** ---
            document.querySelectorAll('.subject-choice').forEach(card => {
                card.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    const subjectName = card.dataset.subjectName;
                    const subjectId = card.dataset.subjectId;
                    
                    document.getElementById('subject-detail-title').textContent = subjectName;

                    // --- NEW DYNAMIC LECTURE CARD LOGIC ---
                    // Find the correct data source
                    let dataSet;
                    if (currentYear === 'متطلبات الجامعة') {
                        dataSet = subjectsData[currentYear];
                    } else if (yearsWithDepartments.includes(currentYear)) {
                        dataSet = subjectsData[currentYear]?.[currentDepartment];
                    } else {
                        dataSet = subjectsData[currentYear]?.[currentSemester];
                    }
                    
                    const subjectData = dataSet?.find(s => (typeof s === 'object' ? s.id : s) === subjectId);
                    
                    const lecturesContainer = document.getElementById('tab-lectures-content');
                    lecturesContainer.innerHTML = ''; // Clear previous

                    let hasLectureData = false;
                    // Check if subjectData is an object and has a lectures array
                    if (typeof subjectData === 'object' && subjectData.lectures) {
                        hasLectureData = true;
                        
                        // Loop 8 times as requested
                        for (let i = 0; i < 8; i++) {
                            const lectureNum = i + 1;
                            const lectureData = subjectData.lectures[i]; // Get data for this lecture (might be undefined)

                            const youtubeLink = lectureData?.youtube;
                            const labLink = lectureData?.lab;
                            const pdfLink = lectureData?.pdf;

                            const lectureCardHTML = `
                                <div class="bg-white bg-opacity-5 p-4 rounded-lg shadow-lg">
                                    <h4 class="text-xl font-semibold mb-4 text-white">المحاضرة ${lectureNum}</h4>
                                    <div class="flex items-center justify-center gap-4 sm:gap-6">
                                        ${generateLinkButton(youtubeLink, 'youtube')}
                                        ${generateLinkButton(labLink, 'lab')}
                                        ${generateLinkButton(pdfLink, 'pdf')}
                                    </div>
                                </div>
                            `;
                            lecturesContainer.innerHTML += lectureCardHTML;
                        }
                    }
                    
                    if (!hasLectureData) {
                         // Fallback for subjects without specific lecture data
                         lecturesContainer.innerHTML = `<p class="text-center col-span-full text-gray-300">لا توجد بيانات محاضرات مُضافة لهذه المادة حتى الآن.</p>`;
                    }
                    // --- END NEW LOGIC ---

                    // Reset tabs to show "Summaries" first by default
                    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelector('.tab-btn[data-tab="tab-summaries"]').classList.add('active');
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
                    document.getElementById('tab-summaries').classList.remove('hidden');


                    navigateToPage('page-subject-detail');
                });
            });
        }


        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            setDailyVerse();
            
            // Restore state from sessionStorage on page load
            currentYear = sessionStorage.getItem('currentYear') || '';
            currentSemester = sessionStorage.getItem('currentSemester') || '';
            currentDepartment = sessionStorage.getItem('currentDepartment') || '';
            
            let initialPageId = window.location.hash.substring(1) || 'page-home';
            if (!document.getElementById(initialPageId)) {
                initialPageId = 'page-home';
            }
            
            history.replaceState({ pageId: initialPageId }, '', `#${initialPageId}`);

            pageContents.forEach(p => p.classList.add('hidden'));
            
            // Navigate to the correct initial page, which will also trigger rendering
            navigateToPage(initialPageId, true);
        });

        window.addEventListener('popstate', (event) => {
            if (event.state && event.state.pageId) {
                navigateToPage(event.state.pageId, true);
            } else {
                navigateToPage('page-home', true);
            }
        });

        openMenuBtn.addEventListener('click', openMenu);
        closeMenuBtn.addEventListener('click', closeMenu);
        menuOverlay.addEventListener('click', closeMenu);

        menuLinks.forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const targetId = link.getAttribute('data-target');
                navigateToPage(targetId);
            });
        });

        startExploringBtn.addEventListener('click', (event) => {
            event.preventDefault();
            navigateToPage('page-academic-years');
        });

        document.querySelectorAll('.year-choice').forEach(card => {
            card.addEventListener('click', (e) => {
                e.preventDefault();
                currentYear = card.dataset.year;
                // Reset lower-level selections when a new year is chosen
                currentSemester = ''; 
                currentDepartment = '';
                saveState(); // Save the new state

                const yearsWithDepartments = ['السنة الثانية', 'السنة الثالثة', 'السنة الرابعة'];
                
                if (yearsWithDepartments.includes(currentYear)) {
                    navigateToPage('page-departments');
                } else if (currentYear === 'متطلبات الجامعة') {
                    // Directly show subjects for 'متطلبات الجامعة'
                    navigateToPage('page-subjects-list');
                }
                else { 
                    // Handles 'السنة الأولى' and 'دراسات عليا'
                    navigateToPage('page-semesters');
                }
            });
        });

        document.querySelectorAll('.semester-choice').forEach(card => {
            card.addEventListener('click', (e) => {
                e.preventDefault();
                currentSemester = card.dataset.semester;
                saveState(); // Save state
                navigateToPage('page-subjects-list');
            });
        });
        
        // --- CORRECTED BACK BUTTON LOGIC ---
        // This single listener handles all back buttons correctly.
        document.querySelectorAll('.back-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = button.dataset.target;
                if (targetId) {
                    navigateToPage(targetId);
                } else {
                    // Fallback to history if no target is specified
                    window.history.back();
                }
            });
        });

        const tabButtons = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                tabButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                tabContents.forEach(content => content.classList.add('hidden'));
                document.getElementById(button.dataset.tab).classList.remove('hidden');
            });
        });

        showLinksBtn.addEventListener('click', () => {
            socialLinksContainer.classList.toggle('hidden');
            if (!socialLinksContainer.classList.contains('hidden')) {
                socialLinksContainer.classList.add('links-enter');
            } else {
                socialLinksContainer.classList.remove('links-enter');
            }
        });
        
        const goHome = () => navigateToPage('page-home');
        logoText.addEventListener('click', goHome);
        logoIcon.addEventListener('click', goHome);

    </script>
</body>
</html>

