<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cairo SciVerse</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(160deg, #18A492, #397A88);
        }
        .quran-box {
            background-color: rgba(42, 110, 101, 0.7);
        }
        .side-menu {
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            background-color: rgba(30, 80, 75, 0.8);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transform: translateX(100%);
        }
        .side-menu.open {
            transform: translateX(0);
        }
        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(25px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pageEnter {
            from { opacity: 0; transform: perspective(800px) rotateX(-15deg) translateY(30px); }
            to { opacity: 1; transform: perspective(800px) rotateX(0deg) translateY(0); }
        }
        @keyframes linksEnter {
          from { opacity: 0; transform: translateY(-20px); }
          to { opacity: 1; transform: translateY(0); }
        }
        @keyframes menuItemEnter {
             from { opacity: 0; transform: translateX(25px); }
             to { opacity: 1; transform: translateX(0); }
        }
        .page-content {
            animation: pageEnter 0.7s ease-out forwards;
        }
        .animate-on-load { opacity: 0; }
        .fade-in-up-1 { animation: fadeInUp 0.6s 0.2s ease-out forwards; }
        .fade-in-up-2 { animation: fadeInUp 0.6s 0.3s ease-out forwards; }
        .fade-in-up-3 { animation: fadeInUp 0.6s 0.4s ease-out forwards; }
        .fade-in-up-4 { animation: fadeInUp 0.6s 0.5s ease-out forwards; }
        .fade-in-up-5 { animation: fadeInUp 0.6s 0.6s ease-out forwards; }
        .fade-in-up-6 { animation: fadeInUp 0.6s 0.7s ease-out forwards; }
        .fade-in-up-7 { animation: fadeInUp 0.6s 0.8s ease-out forwards; }
        .fade-in-up-8 { animation: fadeInUp 0.6s 0.9s ease-out forwards; }
        .menu-item-animate { opacity: 0; animation: menuItemEnter 0.5s ease-out forwards; }
        .links-enter { animation: linksEnter 0.5s ease-out; }
        .icon-container, #start-exploring-btn { transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .icon-container:hover { transform: translateY(-5px); color: #E9C46A; }
        #start-exploring-btn:hover { transform: scale(1.05); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); }
        .card-style {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
        }
        .card-style:hover {
            transform: translateY(-8px);
            background-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
        }
        .card-style .icon-wrapper svg {
            width: 2.75rem; height: 2.75rem;
            stroke-width: 1.5; color: #E9C46A; margin-bottom: 0.5rem;
        }
        .card-style .card-text {
            font-size: 1.125rem; font-weight: 600; color: #FFFFFF;
        }
        .subject-item {
            background-color: rgba(255, 255, 255, 0.08);
            padding: 1rem 1.5rem; border-radius: 0.75rem;
            transition: all 0.2s ease-in-out; cursor: pointer;
        }
        .subject-item:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateX(-5px);
        }
        .tab-btn {
            padding: 0.75rem 1.5rem; border-radius: 0.5rem;
            background-color: transparent; color: rgba(255, 255, 255, 0.7);
            transition: all 0.3s ease;
        }
        .tab-btn.active {
            background-color: rgba(255, 255, 255, 0.15); color: #FFFFFF; font-weight: 700;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .back-btn {
            position: absolute; top: 1.5rem; left: 1.5rem;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 9999px; padding: 0.5rem;
            transition: background-color 0.2s;
        }
        .back-btn:hover { background-color: rgba(255, 255, 255, 0.25); }
    </style>
</head>
<body class="gradient-bg text-white min-h-screen flex flex-col overflow-x-hidden">

    <div id="menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden transition-opacity duration-300"></div>
    <div id="side-menu" class="side-menu fixed top-0 right-0 h-full w-72 shadow-2xl z-50 p-6">
        <div class="flex justify-between items-center mb-10">
            <h2 class="text-2xl font-bold text-white">القائمة</h2>
            <button id="close-menu-btn" class="text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
        </div>
        <nav>
            <ul class="space-y-2">
                <li><a href="#" data-target="page-home" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">الرئيسية</a></li>
                <!-- Other menu items -->
                <li><a href="#" data-target="page-about" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">عن الفريق</a></li>
                <li><a href="#" data-target="page-contact" class="menu-link block p-3 text-lg text-gray-200 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors duration-200">تواصل معنا</a></li>
            </ul>
        </nav>
    </div>

    <div id="app-container" class="flex-grow container mx-auto px-4 py-6">

        <header class="flex justify-between items-center mb-12">
            <button id="open-menu-btn" class="text-3xl text-white z-20"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg></button>
            <h1 id="logo-text" class="text-2xl font-bold cursor-pointer">Cairo SciVerse</h1>
            <div id="logo-icon" class="w-10 h-10 bg-white bg-opacity-90 rounded-full flex items-center justify-center font-bold text-lg text-[#397A88] cursor-pointer">SV</div>
        </header>

        <main class="relative">
            <!-- Home Page -->
            <div id="page-home" class="page-content">
                 <div class="text-center my-10">
                    <h2 class="animate-on-load text-3xl md:text-4xl font-semibold leading-tight mb-10 max-w-lg mx-auto">كل ما تحتاجه لرحلتك في كلية العلوم.</h2>
                    <a href="#" id="start-exploring-btn" class="animate-on-load bg-white text-[#264653] font-bold py-3 px-12 rounded-full text-lg hover:bg-opacity-90 duration-300 inline-block shadow-lg">ابدأ الاستكشاف</a>
                    <div class="animate-on-load flex justify-center items-center gap-12 md:gap-16 my-12">
                        <div class="flex flex-col items-center space-y-3 text-white icon-container">
                            <div class="w-16 h-16 flex items-center justify-center text-3xl font-light"><svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6m0 10v-5m-3 5v-5m-6 5h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg></div>
                            <span class="font-semibold">رياضة</span>
                        </div>
                        <div class="flex flex-col items-center space-y-3 text-white icon-container">
                            <div class="w-16 h-16 flex items-center justify-center text-3xl font-light"><svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg></div>
                            <span class="font-semibold">فيزياء</span>
                        </div>
                        <div class="flex flex-col items-center space-y-3 text-white icon-container">
                             <div class="w-16 h-16 flex items-center justify-center text-3xl font-light"><svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 2a10 10 0 100 20 10 10 0 000-20z" /><path d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547 2 2 0 00-.547 1.806l.477 2.387a6 6 0 00.517 3.86l.158.318a6 6 0 00.517 3.86l2.387.477a2 2 0 001.806-.547 2 2 0 00.547-1.806l-.477-2.387a6 6 0 00-.517-3.86l-.158-.318a6 6 0 00-.517-3.86l-2.387-.477a2 2 0 00-1.806.547 2 2 0 00-.547 1.806l.477 2.387a6 6 0 00.517 3.86l.158.318a6 6 0 00.517 3.86l2.387.477a2 2 0 001.806-.547 2 2 0 00.547-1.806l-.477-2.387a6 6 0 00-.517-3.86l-.158-.318a6 6 0 00-.517-3.86z" /></svg></div>
                            <span class="font-semibold">كيمياء</span>
                        </div>
                    </div>
                     <div class="animate-on-load my-12 max-w-md mx-auto">
                        <p class="text-lg text-gray-200 mb-6">وَذَكِّرْ فَإِنَّ الذِّكْرَىٰ تَنفَعُ الْمُؤْمِنِينَ</p>
                        <div class="quran-box p-6 rounded-2xl text-center shadow-lg">
                            <p id="quran-verse-text" class="text-xl leading-relaxed font-serif mb-4"></p>
                            <cite id="quran-verse-surah" class="not-italic text-gray-300"></cite>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Academic Years Page -->
            <div id="page-academic-years" class="page-content hidden">
                <div class="text-center p-8">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4 animate-on-load">اختر سنتك الدراسية</h2>
                    <p class="text-lg text-gray-200 mb-12 animate-on-load">تصفح المواد والمصادر الخاصة بكل مرحلة.</p>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-6 max-w-3xl mx-auto">
                        <div data-year="year1" class="card-style year-card animate-on-load"><div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg></div><span class="card-text">السنة الأولى</span></div>
                        <div data-year="year2" class="card-style year-card animate-on-load"><div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 4h15M6 4v16h12V4M8 12h8" /></svg></div><span class="card-text">السنة الثانية</span></div>
                        <div data-year="year3" class="card-style year-card animate-on-load"><div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="1.5" /><ellipse cx="12" cy="12" rx="10" ry="4" /><ellipse cx="12" cy="12" rx="4" ry="10" transform="rotate(60 12 12)" /><ellipse cx="12" cy="12" rx="4" ry="10" transform="rotate(-60 12 12)" /></svg></div><span class="card-text">السنة الثالثة</span></div>
                        <div data-year="year4" class="card-style year-card animate-on-load"><div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4c0 5.523 4.477 10 10 10s10-4.477 10-10M4 20c0-5.523 4.477-10 10-10s10 4.477 10 10M8 8h8m-8 8h8" /></svg></div><span class="card-text">السنة الرابعة</span></div>
                        <div data-year="postgrad" class="card-style year-card animate-on-load col-span-2 md:col-auto"><div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M22 10v6M2 10l10-5 10 5-10 5z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M6 12v5c0 1.66 4 3 6 3s6-1.34 6-3v-5"></path></svg></div><span class="card-text">دراسات عليا</span></div>
                        <div data-year="elective" class="card-style year-card animate-on-load"><div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.25l-6.18 3.77L7 14.14l-5-4.87 6.91-1.01L12 2z" /></svg></div><span class="card-text">مواد حرة</span></div>
                    </div>
                </div>
            </div>

            <!-- Semester Selection Page -->
            <div id="page-semester-selection" class="page-content hidden">
                <div class="text-center p-8 relative">
                    <button class="back-btn" data-target="page-academic-years"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 12h14" /></svg></button>
                    <h2 id="semester-page-title" class="text-3xl md:text-4xl font-bold mb-4 animate-on-load">اختر الفصل الدراسي</h2>
                    <p class="text-lg text-gray-200 mb-12 animate-on-load">حدد الترم لعرض المواد الخاصة به.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-lg mx-auto">
                        <div data-term="term1" class="card-style term-card animate-on-load"><div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4m13 0v4m-2-4h4M8 21V5a2 2 0 012-2h4a2 2 0 012 2v16m-3-14h.01" /></svg></div><span class="card-text">الترم الأول</span></div>
                        <div data-term="term2" class="card-style term-card animate-on-load"><div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4m13 0v4m-2-4h4m-1 4v10a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2h12.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V9" /></svg></div><span class="card-text">الترم الثاني</span></div>
                    </div>
                </div>
            </div>

            <!-- Subjects List Page -->
            <div id="page-subjects-list" class="page-content hidden">
                <div class="p-8 relative">
                    <button class="back-btn" data-target="page-semester-selection"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 12h14" /></svg></button>
                    <div class="text-center">
                        <h2 id="subjects-page-title" class="text-3xl md:text-4xl font-bold mb-4 animate-on-load">قائمة المواد</h2>
                        <p id="subjects-page-subtitle" class="text-lg text-gray-200 mb-12 animate-on-load">اختر المادة لعرض تفاصيلها.</p>
                    </div>
                    <div id="subjects-container" class="space-y-4 max-w-2xl mx-auto">
                        <!-- Subjects will be injected here by JS -->
                    </div>
                </div>
            </div>
            
            <!-- Subject Details Page -->
            <div id="page-subject-details" class="page-content hidden">
                <div class="p-8 relative">
                     <button class="back-btn" data-target="page-subjects-list"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 12h14" /></svg></button>
                    <div class="text-center">
                        <h2 id="subject-details-title" class="text-3xl md:text-4xl font-bold mb-8 animate-on-load">اسم المادة</h2>
                    </div>
                    <div class="max-w-3xl mx-auto">
                        <div id="tabs-container" class="flex justify-center items-center gap-4 mb-6 border-b border-white/20 pb-2">
                            <button data-target="tab-summaries" class="tab-btn active">ملخصات</button>
                            <button data-target="tab-lectures" class="tab-btn">محاضرات</button>
                            <button data-target="tab-instructions" class="tab-btn">تعليمات المادة</button>
                        </div>
                        <div id="tabs-content-container" class="mt-8">
                            <div id="tab-summaries" class="tab-content active"><p class="text-center text-lg text-gray-200">هنا ستجد ملخصات المادة.</p></div>
                            <div id="tab-lectures" class="tab-content"><p class="text-center text-lg text-gray-200">هنا ستجد محاضرات المادة.</p></div>
                            <div id="tab-instructions" class="tab-content"><p class="text-center text-lg text-gray-200">هنا ستجد تعليمات وإرشادات هامة للمادة.</p></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other Pages (Contact, About, etc.) -->
            <div id="page-about" class="page-content hidden"><div class="text-center p-8"><h2 class="text-4xl font-bold mb-4">عن فريق Cairo SciVerse</h2><p class="text-lg text-gray-200">تعرف على الفريق القائم على هذا المشروع وأهدافه.</p></div></div>
            <div id="page-contact" class="page-content hidden">...</div>

        </main>
    </div>

    <footer class="text-center text-gray-200 text-sm pb-8 px-4">
        <p class="mb-2">بُني هذا الصرح الرقمي لإلهام ودعم كل طالب علم. من فريق Cairo SciVerse إلى زملائنا.</p>
        <p>&copy; 2025 | موقع Cairo SciVerse. كل الحقوق محفوظة.</p>
    </footer>
    
    <div class="w-full bg-transparent flex justify-center py-4">
      <div class="w-32 h-1.5 bg-white rounded-full"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Data Store ---
            const subjectsData = {
                year1: {
                    name: 'السنة الأولى',
                    term1: ['فيزياء عامة (١)', 'كيمياء عامة (١)', 'رياضيات (١)', 'جيولوجيا', 'ميكانيكا', 'حقوق إنسان'],
                    term2: ['فيزياء عامة (٢)', 'كيمياء عامة (٢)', 'رياضيات (٢)', 'برمجة', 'إحصاء', 'تفكير نقدي']
                },
                year2: {
                    name: 'السنة الثانية',
                    term1: ['مادة سنة تانية ترم أول ١', 'مادة سنة تانية ترم أول ٢'],
                    term2: ['مادة سنة تانية ترم تاني ١', 'مادة سنة تانية ترم تاني ٢']
                }
                // Add other years similarly
            };

            // --- State Management ---
            let currentState = {
                page: 'page-home',
                year: null,
                term: null,
                subject: null,
            };
            const navigationStack = ['page-home'];

            // --- DOM Elements ---
            const openMenuBtn = document.getElementById('open-menu-btn');
            const closeMenuBtn = document.getElementById('close-menu-btn');
            const sideMenu = document.getElementById('side-menu');
            const menuOverlay = document.getElementById('menu-overlay');
            const pageContents = document.querySelectorAll('.page-content');
            
            // --- Daily Verse Logic ---
            const dailyVerses = [
                { text: "إِنَّ فِي خَلْقِ السَّمَاوَاتِ وَالْأَرْضِ وَاخْتِلَافِ اللَّيْلِ وَالنَّهَارِ لَآيَاتٍ لِّأُولِي الْأَلْبَابِ", surah: "سورة آل عمران، 190" },
                { text: "وَقُل رَّبِّ زِدْنِي عِلْمًا", surah: "سورة طه، 114" },
                { text: "يَرْفَعِ اللَّهُ الَّذِينَ آمَنُوا مِنكُمْ وَالَّذِينَ أُوتُوا الْعِلْمَ دَرَجَاتٍ", surah: "سورة المجادلة، 11" }
            ];

            function setDailyVerse() {
                const verseTextElement = document.getElementById('quran-verse-text');
                const verseSurahElement = document.getElementById('quran-verse-surah');
                if (!verseTextElement || !verseSurahElement) return;
                const dayOfYear = Math.floor(Date.now() / 86400000);
                const verseIndex = dayOfYear % dailyVerses.length;
                const todayVerse = dailyVerses[verseIndex];
                verseTextElement.textContent = `"${todayVerse.text}"`;
                verseSurahElement.textContent = todayVerse.surah;
            }

            // --- Navigation Logic ---
            function navigateToPage(targetId, isBack = false) {
                if (currentState.page === targetId) return;

                // Animation handling
                pageContents.forEach(page => {
                    page.classList.add('hidden');
                    const animatedChildren = page.querySelectorAll('.animate-on-load');
                    animatedChildren.forEach(child => {
                        child.className = child.className.replace(/\bfade-in-up-\d+\b/g, '').trim();
                    });
                });

                const targetPage = document.getElementById(targetId);
                if (targetPage) {
                    targetPage.classList.remove('hidden');
                    const elementsToAnimate = targetPage.querySelectorAll('.animate-on-load');
                    elementsToAnimate.forEach((el, index) => {
                        el.classList.add(`fade-in-up-${index + 1}`);
                    });
                }
                
                if (!isBack) {
                    if (navigationStack[navigationStack.length - 1] !== targetId) {
                         navigationStack.push(targetId);
                    }
                }

                currentState.page = targetId;
                closeMenu();
            }
            
            function goBack(targetPageId) {
                if (targetPageId) {
                    // This handles back buttons with explicit targets
                    const targetIndex = navigationStack.lastIndexOf(targetPageId);
                    if (targetIndex > -1) {
                         navigationStack.splice(targetIndex + 1);
                    }
                    navigateToPage(targetPageId, true);
                } else {
                     // Generic back if needed
                    if (navigationStack.length > 1) {
                        navigationStack.pop();
                        const previousPage = navigationStack[navigationStack.length - 1];
                        navigateToPage(previousPage, true);
                    }
                }
            }


            // --- UI Population ---
            function showSemesterSelection(yearId) {
                currentState.year = yearId;
                const yearName = subjectsData[yearId]?.name || 'العام الدراسي';
                document.getElementById('semester-page-title').textContent = `اختر الفصل الدراسي - ${yearName}`;
                navigateToPage('page-semester-selection');
            }

            function showSubjectList(termId) {
                currentState.term = termId;
                const subjects = subjectsData[currentState.year]?.[currentState.term];
                const container = document.getElementById('subjects-container');
                container.innerHTML = '';
                if (subjects) {
                    const yearName = subjectsData[currentState.year].name;
                    const termName = termId === 'term1' ? 'الأول' : 'الثاني';
                    document.getElementById('subjects-page-title').textContent = `مواد ${yearName}`;
                    document.getElementById('subjects-page-subtitle').textContent = `الفصل الدراسي ${termName}`;
                    subjects.forEach((subject, index) => {
                        const div = document.createElement('div');
                        div.className = `subject-item animate-on-load fade-in-up-${index+1}`;
                        div.textContent = subject;
                        div.dataset.subject = subject;
                        container.appendChild(div);
                    });
                }
                navigateToPage('page-subjects-list');
            }

            function showSubjectDetails(subjectName) {
                currentState.subject = subjectName;
                document.getElementById('subject-details-title').textContent = subjectName;
                // Reset to the first tab
                document.querySelectorAll('#tabs-container .tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector('#tabs-container .tab-btn[data-target="tab-summaries"]').classList.add('active');
                document.querySelectorAll('#tabs-content-container .tab-content').forEach(content => content.classList.remove('active'));
                document.getElementById('tab-summaries').classList.add('active');
                
                navigateToPage('page-subject-details');
            }

            // --- Event Listeners ---
            function setupEventListeners() {
                openMenuBtn.addEventListener('click', openMenu);
                closeMenuBtn.addEventListener('click', closeMenu);
                menuOverlay.addEventListener('click', closeMenu);
                document.getElementById('logo-text').addEventListener('click', () => navigateToPage('page-home'));
                document.getElementById('logo-icon').addEventListener('click', () => navigateToPage('page-home'));
                
                document.querySelectorAll('.menu-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        navigateToPage(e.currentTarget.dataset.target);
                    });
                });

                document.getElementById('start-exploring-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateToPage('page-academic-years');
                });
                
                document.querySelectorAll('.back-btn').forEach(button => {
                    button.addEventListener('click', (e) => goBack(e.currentTarget.dataset.target));
                });

                document.querySelector('#page-academic-years').addEventListener('click', (e) => {
                    const yearCard = e.target.closest('.year-card');
                    if (yearCard && yearCard.dataset.year) {
                        showSemesterSelection(yearCard.dataset.year);
                    }
                });
                
                document.querySelector('#page-semester-selection').addEventListener('click', (e) => {
                    const termCard = e.target.closest('.term-card');
                    if (termCard && termCard.dataset.term) {
                        showSubjectList(termCard.dataset.term);
                    }
                });

                document.getElementById('subjects-container').addEventListener('click', (e) => {
                    const subjectItem = e.target.closest('.subject-item');
                    if (subjectItem && subjectItem.dataset.subject) {
                        showSubjectDetails(subjectItem.dataset.subject);
                    }
                });

                document.getElementById('tabs-container').addEventListener('click', (e) => {
                    const tabBtn = e.target.closest('.tab-btn');
                    if (tabBtn) {
                        document.querySelectorAll('#tabs-container .tab-btn').forEach(btn => btn.classList.remove('active'));
                        tabBtn.classList.add('active');
                        
                        const targetContentId = tabBtn.dataset.target;
                        document.querySelectorAll('#tabs-content-container .tab-content').forEach(content => {
                            content.classList.toggle('active', content.id === targetContentId);
                        });
                    }
                });
            }

            function openMenu() {
                sideMenu.classList.add('open');
                menuOverlay.classList.remove('hidden');
                sideMenu.querySelectorAll('.menu-link').forEach((link, index) => {
                    link.classList.add('menu-item-animate');
                    link.style.animationDelay = `${index * 0.07 + 0.1}s`;
                });
            }

            function closeMenu() {
                sideMenu.classList.remove('open');
                menuOverlay.classList.add('hidden');
                sideMenu.querySelectorAll('.menu-link').forEach(link => {
                    link.classList.remove('menu-item-animate');
                    link.style.animationDelay = '';
                });
            }

            // --- Initialization ---
            setDailyVerse();
            setupEventListeners();
            navigateToPage('page-home'); // Trigger initial animation
        });
    </script>
</body>
</html>


